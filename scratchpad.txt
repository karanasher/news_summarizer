--------------
TODO
--------------
Have defaults for all columns in the models.py file. There is a chance that thee API may not give us the info.
Use .get for dict in utils.py and take appropriate action.

--------------
SCRATCHPAD
--------------
from transformers import T5ForConditionalGeneration, T5Tokenizer
model = T5ForConditionalGeneration.from_pretrained("t5-small")
model.save_pretrained("saved_summarization_model")
tokenizer = T5Tokenizer.from_pretrained("t5-small")
article = """
... Justin Timberlake and Jessica Biel, welcome to parenthood.
... The celebrity couple announced the arrival of their son, Silas Randall Timberlake, in statements to People.
... "Silas was the middle name of Timberlake's maternal grandfather Bill Bomar, who died in 2012, while Randall is the musician's own middle name, as well as his father's first," People reports.
... The couple announced the pregnancy in January, with an Instagram post. It is the first baby for both.
... """
inputs = tokenizer.encode("summarize: " + article, return_tensors="pt", max_length=512, truncation=True)
model = T5ForConditionalGeneration.from_pretrained('./saved_summarization_model', cache_dir=None)

tokenizer.save_pretrained("saved_tokenizer")
tokenizer = T5Tokenizer.from_pretrained('./saved_tokenizer', cache_dir=None)
outputs = model.generate(     inputs,      max_length=150,      min_length=40,      length_penalty=2.0,      num_beams=4,      early_stopping=True)
print(outputs)
print(tokenizer.decode(outputs[0]))


from transformers import TFAutoModelWithLMHead, T5Tokenizer

model = TFAutoModelWithLMHead.from_pretrained("t5-small")
tokenizer = T5Tokenizer.from_pretrained("t5-small")

model.save_pretrained("saved_summarization_model")
tokenizer.save_pretrained("saved_tokenizer")

model = TFAutoModelWithLMHead.from_pretrained('./saved_summarization_model', cache_dir=None)
tokenizer = T5Tokenizer.from_pretrained('./saved_tokenizer', cache_dir=None)

article = """
... Justin Timberlake and Jessica Biel, welcome to parenthood.
... The celebrity couple announced the arrival of their son, Silas Randall Timberlake, in statements to People.
... "Silas was the middle name of Timberlake's maternal grandfather Bill Bomar, who died in 2012, while Randall is the musician's own middle name, as well as his father's first," People reports.
... The couple announced the pregnancy in January, with an Instagram post. It is the first baby for both.
... """

inputs = tokenizer.encode("summarize: " + article, return_tensors="tf", max_length=512, truncation=True)
outputs = model.generate(     inputs,      max_length=150,      min_length=40,      length_penalty=2.0,      num_beams=4,      early_stopping=True)
print(outputs)
print(tokenizer.decode(outputs[0]))


--------------
from transformers import TFAutoModelWithLMHead, AutoTokenizer

model = TFAutoModelWithLMHead.from_pretrained("t5-small")
tokenizer = AutoTokenizer.from_pretrained("t5-small")

ARTICLE = """
With lawmakers facing a mounting year-end to-do list, a deal on a new coronavirus relief package continues to be elusive for Congress.

But a key House Democrat on Sunday seemed to indicate some flexibility on one of his party's priorities.

"[Democrats] are not going to get everything we want," House Majority Leader Steny Hoyer, D-Md., said on CNN's Inside Politics. "We think state and local [aid] is important. And if we can get that, we want to get it. But we want to get aid out to the people who are really, really struggling and are at grave risk."

Several existing federal programs, including some unemployment benefits, are set to expire at the end of the month.

Hoyer, who said he's spent the weekend negotiating with congressional leaders on the relief package, emphasized that legislators have to compromise in order to get a deal, saying, "life is a series of tradeoffs and give and takes."

Hoyer added: "We need to get the essential done and we'll have time to get stuff done that we didn't include because we couldn't get political agreement."

Coronavirus aid could be passed along with a year-end spending bill. On Friday evening, President Trump signed a one-week temporary funding measure in order to avoid a government shutdown.

Sen. Bernie Sanders, I-Vt., who was seeking a vote on a measure that would send direct payments to Americans, said he will raise his demands again when the continuing resolution expires in one week.

"If I have anything to say about it, and I guess I do, we're not going to go home for the Christmas holidays unless we make sure that we provide for the millions of families in this country who are suffering," Sanders said on the Senate floor on Friday.

On Sunday, Sen. Chris Coons, D-Del., told NBC's Meet The Press he is "frustrated and embarrassed" by the current absence of a new round of coronavirus relief.

"Bluntly, I will put a lot of that responsibility at the feet of the leader of the Senate Republican majority, Mitch McConnell, because over and over, as negotiations have tried to move forward over the last nine months, he's had a key red line and sticking point," Coons said.

Kentucky's McConnell has sought a liability shield to protect businesses against coronavirus-related lawsuits and from some regulations. McConnell on Tuesday had suggested both sides leave off sought-after provisions from a final agreement.

Despite his frustration, Coons, an ally of President-elect Joe Biden, said he's optimistic because of a bipartisan group of lawmakers who developed a $908 billion relief framework.

That group includes Coons' Democratic colleague from West Virginia, Sen. Joe Manchin, who on Sunday said he believes the bill's text will be finalized by Monday.

"It hasn't fallen apart," he said on Fox News Sunday. "We've been meeting day and night for the last month. We were on the call all day yesterday, we get on the call again this afternoon to finish things up. We'll have a bill produced for the American people tomorrow, $908 billion."

Manchin acknowledged that legislation that size will have areas on which not every lawmaker will agree. He cautioned: "You can't let the perfect be the enemy of the good."

He stressed the bill is an emergency measure that will only cover the first quarter of 2021.

"We've got people without nutrition, we have people without shelter, we have people without paychecks, they're unemployed, we have hospitals that are being overburdened, we have health care workers, we have schools that need to be attended to â€” this covers all of that," Manchin said.
Meanwhile, Trump has once again threatened to veto the annual defense bill.

"THE BIGGEST WINNER OF OUR NEW DEFENSE BILL IS CHINA!. I WILL VETO!" he wrote on Twitter Sunday morning.

As part of the massive annual legislation, the president has wanted Congress to repeal a liability shield for social media companies, known as Section 230.

Despite Trump's protestations, the House and Senate have passed the bill, without a Section 230 repeal, by veto-proof majorities. If Trump does indeed veto the legislation, the chambers could override it.
"""

inputs = tokenizer.encode("summarize: " + ARTICLE, return_tensors="tf", max_length=512)
outputs = model.generate(inputs, max_length=100, min_length=40, length_penalty=2.0, num_beams=4, early_stopping=True)
summary = tokenizer.decode(outputs[0])
print(summary)
